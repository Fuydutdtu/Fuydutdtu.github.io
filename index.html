<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lsplash Live Tracker</title>
  <style>
    body {
      background-color: #2f3136;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      color: #fff;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    .tracker-container {
      max-width: 750px;
      margin: 0 auto;
      background: #36393f;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.7);
      flex: 1;
    }
    .tracker-header {
      text-align: center;
      margin-bottom: 20px;
    }
    .tracker-header img {
      border-radius: 50%;
      width: 150px;
      height: 150px;
      object-fit: cover;
      margin-bottom: 10px;
    }
    .tracker-title {
      font-size: 32px;
      color: #00FF00;
    }
    .section {
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #444;
      border-radius: 5px;
      background: #2c2f33;
    }
    .section-title {
      font-size: 24px;
      margin-bottom: 10px;
      color: #00FF00;
      border-bottom: 1px solid #444;
      padding-bottom: 5px;
    }
    .field {
      margin-bottom: 8px;
      line-height: 1.5;
    }
    .field span.label {
      display: inline-block;
      width: 210px;
      font-weight: bold;
    }
    footer {
      text-align: center;
      margin-top: 20px;
      padding: 10px;
      background: #36393f;
      border-radius: 8px;
      font-size: 14px;
      color: #aaa;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    footer img {
      border-radius: 50%;
      width: 30px;
      height: 30px;
    }
  </style>
</head>
<body>
  <div class="tracker-container">
    <div class="tracker-header">
      <img src="images/splash.jpg" alt="Lsplash">
      <div class="tracker-title">Lsplash Live Tracker</div>
    </div>
    <!-- System Data Section -->
    <div class="section" id="systemData">
      <div class="section-title">üñ•Ô∏è System Data</div>
      <div class="field" id="ipField"></div>
      <div class="field" id="locationField"></div>
      <div class="field" id="deviceField"></div>
      <div class="field" id="appsField"></div>
      <div class="field" id="cpuField"></div>
      <div class="field" id="uptimeField"></div>
      <div class="field" id="networkField"></div>
      <div class="field" id="headphoneField"></div>
      <div class="field" id="usageModeField"></div>
    </div>
    <!-- Personal Data Section -->
    <div class="section" id="personalData">
      <div class="section-title">üíì Personal Data</div>
      <div class="field" id="heartField"></div>
      <div class="field" id="tempField"></div>
      <div class="field" id="energyField"></div>
      <div class="field" id="sleepField"></div>
      <div class="field" id="lastSeenField"></div>
      <div class="field" id="activityField"></div>
      <div class="field" id="keysField"></div>
      <div class="field" id="phoneField"></div>
    </div>
    <!-- Mental State Section -->
    <div class="section" id="mentalState">
      <div class="section-title">üß† Mental State</div>
      <div class="field" id="stressField"></div>
      <div class="field" id="thoughtField"></div>
      <div class="field" id="timeField"></div>
    </div>
  </div>

  <!-- Footer Section -->
  <footer>
    <img src="images/pfp.jpg" alt="Profile Picture">
    <div>
      <strong>Made By RobloxEmployee</strong><br>
      Detailed tracking for your door development day.
    </div>
  </footer>

  <script>
    /* ---------------- Utility Functions ---------------- */
    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    function getRandomFloat(min, max) {
      return (Math.random() * (max - min) + min).toFixed(1);
    }
    function getMinutesSinceMidnight() {
      const now = new Date();
      return now.getHours() * 60 + now.getMinutes();
    }

    /* ---------------- Location & Schedule Data ---------------- */
    const locationMapping = {
      "Home": { description: "Home", travelTime: 0 },
      "Redibles": { description: "At Redibles", travelTime: 5 * 60000 },
      "Jasper's House": { description: "At Jasper's House", travelTime: 8 * 60000 }
    };
    const addresses = Object.keys(locationMapping);

    // Detailed schedule (times in minutes since midnight: wake at 6:30, sleep at 22:28)
    const dailySchedule = [
      { start: 390, end: 405, activity: "üöΩ Morning Routine: Wake up, bathroom, brush teeth" },
      { start: 405, end: 435, activity: "‚òï Breakfast & Daily Planning" },
      { start: 435, end: 480, activity: "üìß Check emails and review schedule" },
      { start: 480, end: 600, activity: "üíª Coding & Debugging Door Mechanics" },
      { start: 600, end: 615, activity: "üîÑ Short Break: Stretch, quick snack" },
      { start: 615, end: 720, activity: "üé® Designing New Door Features & Animations" },
      { start: 720, end: 750, activity: "üç¥ Lunch Break" },
      { start: 750, end: 900, activity: "üö™ Intensive Development: Implementing & testing door logic" },
      { start: 900, end: 915, activity: "‚òï Afternoon Break: Bathroom & coffee" },
      { start: 915, end: 1020, activity: "ü§ù Collaboration: Video calls with Redibles/Jasper, brainstorming door lore" },
      { start: 1020, end: 1080, activity: "üöÄ Prototyping & Testing: Refining door animations and code" },
      { start: 1080, end: 1230, activity: "üéÆ Creative Break: Play Ragdoll Universe & review new ideas" },
      { start: 1230, end: 1348, activity: "üåô Wind Down: Wrap up work, plan next day, personal time" }
    ];

    /* ---------------- Extensive Thoughts & Sub-Activities ---------------- */
    const thoughtsList = [
      // 100+ detailed thoughts
      "Time to optimize the door collision detection algorithm.",
      "Reviewing the door unlocking logic‚Äîneed to tighten security.",
      "Maybe add a subtle ambient sound for door opening.",
      "Revisiting user feedback on door animations.",
      "Refactoring the door state machine for better performance.",
      "Experimenting with dynamic lighting on door models.",
      "Checking the door texture mapping for smoother transitions.",
      "Documenting recent door bug fixes.",
      "Brainstorming ideas for a secret door easter egg.",
      "Running unit tests on the door module.",
      "Integrating new animations for a smoother door swing.",
      "Analyzing performance logs for door interactions.",
      "Collaborating with the design team on door aesthetics.",
      "Updating the code comments for clarity in door functions.",
      "Reviewing community suggestions for door features.",
      "Optimizing door rendering for lower-end devices.",
      "Drafting a design document for the next door update.",
      "Checking door collision boundaries against physics simulation.",
      "Sketching a storyboard for a door transition sequence.",
      "Reviewing the latest commit on door unlocking code.",
      "Evaluating the impact of door glitches on user experience.",
      "Planning a team meeting to discuss door UI improvements.",
      "Testing door behavior under high network latency.",
      "Comparing door mechanics with industry standards.",
      "Brainstorming modular door design for scalability.",
      "Analyzing user metrics on door interaction frequency.",
      "Optimizing the door asset pipeline for faster load times.",
      "Reviewing API changes affecting door animations.",
      "Refining sound synchronization for door events.",
      "Updating the door module with new error handling routines.",
      "Researching advanced collision detection for doors.",
      "Examining door locking mechanisms for potential improvements.",
      "Tuning door swing speed for a more natural feel.",
      "Documenting lessons learned from recent door patch.",
      "Reviewing the door module‚Äôs integration with the physics engine.",
      "Sketching a new layout for the door interface.",
      "Evaluating the energy cost of door animations.",
      "Brainstorming seasonal themes for door designs.",
      "Checking compatibility of door assets with new platform updates.",
      "Assessing the scalability of door mechanics in multiplayer mode.",
      "Reviewing code for potential door optimization.",
      "Drafting proposals for an interactive door mini-game.",
      "Testing door unlocking under various user inputs.",
      "Analyzing door module performance benchmarks.",
      "Documenting best practices for door development.",
      "Preparing a demo for the upcoming door feature update.",
      "Reviewing door animation transitions for smoothness.",
      "Refactoring door code to reduce computational overhead.",
      "Comparing door state machines across different projects.",
      "Optimizing door asset memory usage.",
      "Checking for security loopholes in door unlocking code.",
      "Evaluating user interface responsiveness for door controls.",
      "Brainstorming ideas for a hidden door challenge.",
      "Documenting a list of door-related bug reports.",
      "Updating the changelog for recent door improvements.",
      "Testing door interactions on various screen resolutions.",
      "Reviewing team feedback on door feature priorities.",
      "Drafting an email to gather additional door feature suggestions.",
      "Analyzing recurring errors in the door animation cycle.",
      "Researching new libraries for enhanced door rendering.",
      "Cross-referencing door features with user analytics.",
      "Reviewing code structure for door feature modularity.",
      "Planning a collaborative session to innovate door mechanics.",
      "Evaluating the impact of door glitches on overall gameplay.",
      "Optimizing door state transitions to reduce lag.",
      "Documenting design decisions for door security enhancements.",
      "Reviewing network logs for door synchronization issues.",
      "Sketching alternative door layouts for increased engagement.",
      "Testing door performance during peak player loads.",
      "Analyzing the correlation between door interaction and user retention.",
      "Drafting a proposal for advanced door customization options.",
      "Reviewing door feature implementation with the QA team.",
      "Brainstorming a narrative hook around a mysterious door.",
      "Testing new door input methods for better usability.",
      "Reviewing code for door animation smoothing techniques.",
      "Documenting performance improvements from the latest door patch.",
      "Evaluating door error rates in the production environment.",
      "Cross-checking door functionality across different devices.",
      "Drafting a presentation on the future of door mechanics.",
      "Optimizing door collision detection using new algorithms.",
      "Reviewing internal documentation on door feature development.",
      "Brainstorming a door mini-game that ties into the lore.",
      "Testing door behavior with simulated high-latency networks.",
      "Analyzing user behavior data related to door interactions.",
      "Preparing a report on door module improvements for stakeholders.",
      "Drafting new test cases for door feature QA.",
      "Evaluating potential enhancements to door sound effects.",
      "Reflecting on past door updates and lessons learned.",
      "Researching industry trends in interactive door design.",
      "Brainstorming potential partnerships for door-themed updates.",
      "Documenting a roadmap for next-quarter door improvements.",
      "Reviewing the door module for potential memory leaks.",
      "Sketching ideas for a door unlocking animation that feels natural.",
      "Testing door responsiveness under rapid user inputs.",
      "Analyzing system logs for door animation inconsistencies.",
      "Drafting detailed user feedback reports on door features.",
      "Reflecting on personal coding strategies for door development.",
      "Evaluating the feasibility of AI-enhanced door interactions.",
      "Preparing a demo showcasing innovative door animations.",
      "Assessing the overall performance of the door module during tests.",
      "Reviewing community feedback for door theme updates.",
      "Testing alternative methods for door state synchronization.",
      "Drafting a new design document for the door user interface.",
      "Reflecting on the balance between door complexity and usability.",
      "Planning a review session on door error handling improvements."
    ];
    
    const activitiesList = [
      "Review door code documentation",
      "Optimize door collision detection",
      "Refactor the door state machine",
      "Test door animation transitions",
      "Debug door unlocking issues",
      "Update door textures",
      "Integrate new door sound effects",
      "Document door bug reports",
      "Collaborate on door design with the team",
      "Review pull requests for door features",
      "Sketch new door animation ideas",
      "Plan a meeting for door brainstorming",
      "Research door physics parameters",
      "Write unit tests for door modules",
      "Conduct user testing on door interactions",
      "Review door-related feedback on forums",
      "Optimize door rendering performance",
      "Implement a new door locking mechanism",
      "Test door behavior on multiple devices",
      "Update the door module in version control",
      "Analyze performance logs for door functions",
      "Prepare a demo for new door features",
      "Refine door collision parameters",
      "Brainstorm hidden door easter eggs",
      "Review community suggestions for door improvements",
      "Draft a design document for a door update",
      "Optimize door code for network latency",
      "Test dynamic lighting effects on doors",
      "Refine door sound synchronization",
      "Document proposals for door features",
      "Brainstorm ideas for secret door puzzles",
      "Test door state transitions under load",
      "Plan an update rollout for door improvements",
      "Review error logs from door interactions",
      "Collaborate on door security enhancements",
      "Check compatibility of door assets with updates",
      "Analyze energy consumption of door animations",
      "Review the door module‚Äôs integration with the physics engine",
      "Sketch a new layout for the door interface",
      "Evaluate energy cost of door animations",
      "Brainstorm seasonal themes for doors",
      "Check compatibility of door assets with platform updates",
      "Assess scalability of door interactions",
      "Review code quality in door functions",
      "Refactor the door unlocking algorithm",
      "Create a checklist for door QA testing",
      "Plan a training session on door development",
      "Compile a list of door feature ideas",
      "Test door glitch fixes in beta",
      "Evaluate door usage metrics",
      "Draft an email for door feature feedback",
      "Research advanced collision algorithms",
      "Brainstorm seasonal door themes",
      "Review door physics simulation data",
      "Test new door hardware integration",
      "Optimize door load times",
      "Plan a collaborative review on door mechanics",
      "Draft improvements for door error handling",
      "Assess door module scalability",
      "Prototype a door mini-game concept",
      "Brainstorm modular door design",
      "Evaluate door code for refactoring",
      "Review community trends for door ideas",
      "Compile a report on door feature usage",
      "Test door interaction under high latency",
      "Draft a roadmap for door updates",
      "Review logs to identify door bugs",
      "Analyze impact of door sound effects",
      "Plan a presentation on door innovations",
      "Conduct a team review on door feedback",
      "Refine door locking mechanism algorithms",
      "Plan a collaborative coding session on doors",
      "Update documentation for door modules",
      "Test door animations in different lighting",
      "Evaluate overall door system performance",
      "Plan a meeting to discuss door improvements",
      "Brainstorm ideas for interactive door puzzles",
      "Review and update door test suites",
      "Analyze door usage data over the past month",
      "Document best practices for door design",
      "Prototype a hidden door feature",
      "Review internal door proposals",
      "Refine the door unlocking minigame",
      "Plan a creative break to gather door ideas",
      "Compile a list of door improvement suggestions"
    ];
    
    function getRandomThought() {
      return thoughtsList[getRandomInt(0, thoughtsList.length - 1)];
    }
    function getRandomActivity() {
      return activitiesList[getRandomInt(0, activitiesList.length - 1)];
    }
    function getThoughtProcess() {
      return getRandomThought();
    }
    // Optionally, include additional sub-activities:
    function getAdditionalActivity() {
      return getRandomActivity();
    }
    
    /* ---------------- Server-Based State Persistence ---------------- */
    // Replace localStorage-based persistence with server calls.
    // For this example, assume there are endpoints at /loadState and /saveState
    async function loadStateFromServer() {
      try {
        let response = await fetch('/loadState'); // Your server should handle this request.
        if (response.ok) {
          return await response.json();
        }
      } catch (e) {
        console.error("Error loading state from server:", e);
      }
      return getDefaultState();
    }
    async function saveStateToServer(state) {
      try {
        await fetch('/saveState', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(state)
        });
      } catch (e) {
        console.error("Error saving state to server:", e);
      }
    }
    
    async function initState() {
      simulationState = await loadStateFromServer();
      if (!simulationState) simulationState = getDefaultState();
    }
    
    /* ---------------- Persistent State Initialization ---------------- */
    let simulationState = {};
    initState().then(() => {
      simulationState.headphoneVolume = simulationState.headphoneStatus === "üéß On" ? `${getRandomInt(10,100)}%` : "N/A";
      // Start the simulation loop after state is loaded
      updateSlowMetrics();
      updateTimeField();
      setInterval(updateSlowMetrics, 30000);
      setInterval(updateTimeField, 1000);
    });
    
    /* ---------------- Leader Election (for multi-tab control) ---------------- */
    const LEADER_TIMEOUT = 2000;
    const myTabId = Date.now() + "-" + Math.random();
    function isLeader() {
      return localStorage.getItem("simulationLeader") === myTabId;
    }
    function updateLeaderHeartbeat() {
      if (isLeader()) {
        localStorage.setItem("simulationLeaderTimestamp", Date.now().toString());
      }
    }
    function tryToBecomeLeader() {
      let currentLeader = localStorage.getItem("simulationLeader");
      let leaderTimestamp = parseInt(localStorage.getItem("simulationLeaderTimestamp") || "0", 10);
      let now = Date.now();
      if (!currentLeader || (now - leaderTimestamp > LEADER_TIMEOUT)) {
        localStorage.setItem("simulationLeader", myTabId);
        localStorage.setItem("simulationLeaderTimestamp", now.toString());
      }
    }
    
    /* ---------------- Scheduled Activity Function ---------------- */
    function getScheduledActivity() {
      const nowMin = getMinutesSinceMidnight();
      if (simulationState.energyLevel <= 0) {
        if (simulationState.current_location !== "Home") {
          simulationState.target_location = "Home";
          simulationState.isTraveling = true;
          simulationState.travelStartTime = Date.now();
          simulationState.travelDuration = locationMapping["Home"].travelTime;
          return "üöó Traveling Home for a Power Nap";
        }
        return "‚òï Taking a Break to Recharge";
      }
      if (simulationState.isTraveling) {
        let elapsed = Date.now() - simulationState.travelStartTime;
        let remaining = simulationState.travelDuration - elapsed;
        let eta = Math.ceil(remaining / 60000);
        if (eta < 1) eta = 1;
        return `üöó Traveling to ${simulationState.target_location} (ETA: ${eta} min)`;
      }
      let scheduled = dailySchedule.find(slot => nowMin >= slot.start && nowMin < slot.end);
      return scheduled ? scheduled.activity : "üíª Idle (reviewing door code)";
    }
    
    /* ---------------- Simulation Functions ---------------- */
    function computeDeltaTime() {
      const now = Date.now();
      const dt = (now - simulationState.lastUpdateTime) / 60000;
      simulationState.lastUpdateTime = now;
      return dt;
    }
    function updateIPAndLocation(now) {
      if (now - simulationState.ip_set_time >= 5 * 60 * 1000) {
        simulationState.current_ip = `192.241.${getRandomInt(0, 255)}.${getRandomInt(0, 255)}`;
        simulationState.ip_set_time = now;
      }
      if (!simulationState.isTraveling && Math.random() < 0.03) {
        let newTarget = addresses[getRandomInt(0, addresses.length - 1)];
        if (newTarget !== simulationState.current_location) {
          simulationState.target_location = newTarget;
          simulationState.isTraveling = true;
          simulationState.travelStartTime = now;
          simulationState.travelDuration = locationMapping[newTarget].travelTime;
        }
      }
    }
    function updateTravel(now) {
      if (simulationState.isTraveling) {
        if (now - simulationState.travelStartTime >= simulationState.travelDuration) {
          simulationState.current_location = simulationState.target_location;
          simulationState.isTraveling = false;
        }
      }
    }
    function getESTTime() {
      let now = new Date();
      let utc = now.getTime() + now.getTimezoneOffset() * 60000;
      let est = new Date(utc - (5 * 3600000));
      let hours = est.getHours();
      let minutes = est.getMinutes();
      let ampm = hours >= 12 ? 'PM' : 'AM';
      hours = hours % 12;
      hours = hours ? hours : 12;
      minutes = minutes < 10 ? '0' + minutes : minutes;
      return `${hours}:${minutes} ${ampm}`;
    }
    function getSleepStatus() {
      const nowMin = getMinutesSinceMidnight();
      if (nowMin < 390 || nowMin >= 1348) return "üí§ Sleeping";
      if (nowMin >= 750 && nowMin < 765) return "üò¥ Short Nap";
      return "Awake";
    }
    function updateActivityState(now) {
      let sleepStatus = getSleepStatus();
      if (sleepStatus.includes("Sleeping") || sleepStatus.includes("Nap")) {
        simulationState.current_activity = sleepStatus;
        simulationState.activity_duration = Infinity;
        simulationState.activity_start_time = now;
        return;
      }
      simulationState.current_activity = getScheduledActivity();
      simulationState.activity_duration = 600;
      simulationState.activity_start_time = now;
    }
    function updatePhoneBattery(dtMinutes) {
      if (!simulationState.phoneCharging) {
        simulationState.phone_battery -= dtMinutes * 2;
        if (simulationState.phone_battery <= 15) simulationState.phoneCharging = true;
      } else {
        simulationState.phone_battery += dtMinutes * 5;
        if (simulationState.phone_battery >= 100) {
          simulationState.phone_battery = 100;
          simulationState.phoneCharging = false;
        }
      }
      if (simulationState.phone_battery < 0) simulationState.phone_battery = 0;
    }
    function updateEnergyLevel(dtMinutes) {
      if (simulationState.current_activity.includes("Sleeping") ||
          simulationState.current_activity.includes("Break") ||
          simulationState.current_activity.includes("Nap") ||
          simulationState.current_activity.includes("Wind Down")) {
        simulationState.energyLevel += dtMinutes * 4;
      } else if (simulationState.current_activity.includes("Coding") ||
                 simulationState.current_activity.includes("Debug") ||
                 simulationState.current_activity.includes("Designing") ||
                 simulationState.current_activity.includes("Development") ||
                 simulationState.current_activity.includes("Prototyping")) {
        simulationState.energyLevel -= dtMinutes * 0.7;
      } else if (simulationState.current_activity.includes("Collaboration") ||
                 simulationState.current_activity.includes("Creative Break")) {
        simulationState.energyLevel -= dtMinutes * 0.4;
      } else {
        simulationState.energyLevel -= dtMinutes * 0.2;
      }
      simulationState.energyLevel = Math.min(Math.max(simulationState.energyLevel, 0), 100);
    }
    function updateHeartRate() {
      if (simulationState.current_activity.includes("Sleeping") ||
          simulationState.current_activity.includes("Nap")) {
        simulationState.persistentHeartRate = Math.max(simulationState.persistentHeartRate - 1, 55);
      }
      return simulationState.persistentHeartRate;
    }
    function updateBodyTemp() {
      if (simulationState.current_activity.includes("Sleeping") ||
          simulationState.current_activity.includes("Nap")) {
        simulationState.persistentBodyTemp = 36.5;
      }
      let fahrenheit = (simulationState.persistentBodyTemp * 9/5) + 32;
      return fahrenheit.toFixed(1) + "¬∞F";
    }
    function getStressLevel(activity) {
      if (activity.includes("Debug") || activity.includes("Coding")) return "üò∞ High";
      if (activity.includes("Break") || activity.includes("Wind Down")) return "üòå Low";
      return "üòê Moderate";
    }
    function updateSlowDisplay() {
      document.getElementById("ipField").innerHTML = `<span class="label">üåê IP Address:</span> ${simulationState.current_ip} (updates every ~5 mins)`;
      let locationDisplay = simulationState.isTraveling 
        ? `üöó Traveling to ${simulationState.target_location} (ETA: ${Math.ceil(Math.max((simulationState.travelDuration - (Date.now() - simulationState.travelStartTime))/60000, 1))} min)`
        : simulationState.current_location;
      document.getElementById("locationField").innerHTML = `<span class="label">üìç Location:</span> ${locationDisplay}`;
      let sleepStatus = getSleepStatus();
      let usageMode = simulationState.isTraveling ? "Car" :
                      (sleepStatus.includes("Sleeping") || sleepStatus.includes("Nap") ? "Sleeping" : "PC");
      document.getElementById("usageModeField").innerHTML = `<span class="label">üîå Usage Mode:</span> ${usageMode}`;
      let deviceInfo = usageMode === "PC" ? simulationState.device_info :
                       (usageMode === "Sleeping" ? "No active device (Sleeping)" : "iPhone 13 | iOS 15");
      document.getElementById("deviceField").innerHTML = `<span class="label">üñ•Ô∏è Device Info:</span> ${deviceInfo}`;
      let openApps = getOpenApplications();
      document.getElementById("appsField").innerHTML = `<span class="label">${usageMode==="PC" ? "üóÇÔ∏è Open Apps:" : "üì± Mobile Apps:"}</span> ${openApps.join(", ")}`;
      document.getElementById("cpuField").innerHTML = `<span class="label">üíª CPU Usage:</span> ${simulationState.cpuUsage}%`;
      document.getElementById("uptimeField").innerHTML = `<span class="label">‚è±Ô∏è Uptime:</span> ${simulationState.uptimeHours}h ${simulationState.uptimeMinutes}m`;
      document.getElementById("networkField").innerHTML = `<span class="label">üì° Network:</span> ${simulationState.networkDownload} Mbps ‚Üì | ${simulationState.networkUpload} Mbps ‚Üë`;
      document.getElementById("headphoneField").innerHTML = `<span class="label">üéß Headphones:</span> ${simulationState.headphoneStatus} | Volume: ${simulationState.headphoneVolume}`;
      let activityDisplay = simulationState.current_activity;
      if (simulationState.isTraveling) {
        let remaining = simulationState.travelDuration - (Date.now() - simulationState.travelStartTime);
        let eta = Math.ceil(remaining / 60000);
        if (eta < 1) eta = 1;
        activityDisplay = simulationState.target_location === "Home" ?
                          "üöó Commuting home (ETA: " + eta + " min)" :
                          simulationState.current_activity + " (ETA: " + eta + " min)";
      }
      document.getElementById("activityField").innerHTML = `<span class="label">üìä Activity:</span> ${activityDisplay}`;
      document.getElementById("keysField").innerHTML = `<span class="label">‚å®Ô∏è Keystrokes:</span> ${simulationState.keystrokes} /min`;
      document.getElementById("heartField").innerHTML = `<span class="label">‚ù§Ô∏è Heart Rate:</span> ${updateHeartRate()} BPM`;
      document.getElementById("tempField").innerHTML = `<span class="label">üå°Ô∏è Body Temp:</span> ${updateBodyTemp()}`;
      document.getElementById("energyField").innerHTML = `<span class="label">‚ö° Energy:</span> ${simulationState.energyLevel.toFixed(0)}%`;
      document.getElementById("sleepField").innerHTML = `<span class="label">üõå Sleep:</span> ${sleepStatus}`;
      document.getElementById("lastSeenField").innerHTML = `<span class="label">üëÄ Last Seen:</span> ${simulationState.lastSeen} sec ago`;
      document.getElementById("phoneField").innerHTML = `<span class="label">üì≤ Phone Battery:</span> ${Math.round(simulationState.phone_battery)}% ${simulationState.phoneCharging ? "(Charging)" : "(Discharging)"}`;
      document.getElementById("stressField").innerHTML = `<span class="label">üò∞ Stress:</span> ${getStressLevel(simulationState.current_activity)}`;
      document.getElementById("thoughtField").innerHTML = `<span class="label">üí≠ Thoughts:</span> "${getThoughtProcess()}"`;
    }
    function updateTimeField() {
      document.getElementById("timeField").innerHTML = `<span class="label">üï∞Ô∏è EST Time:</span> ${getESTTime()}`;
    }
    async function updateSlowMetrics() {
      tryToBecomeLeader();
      const now = Date.now();
      const dtMinutes = computeDeltaTime();
      updateIPAndLocation(now);
      updateTravel(now);
      updateActivityState(now);
      updatePhoneBattery(dtMinutes);
      updateEnergyLevel(dtMinutes);
      if (Math.random() < 0.2) {
        simulationState.lastSeen = getRandomInt(1,15);
        simulationState.keystrokes = simulationState.isTraveling || simulationState.current_activity.toLowerCase().includes("break")
                                      ? 0 : getRandomInt(50,200);
        simulationState.cpuUsage = getRandomInt(10,50);
        simulationState.uptimeHours = getRandomInt(1,12);
        simulationState.uptimeMinutes = getRandomInt(0,59);
        simulationState.networkDownload = getRandomFloat(5,15);
        simulationState.networkUpload = getRandomFloat(1,5);
        simulationState.headphoneStatus = Math.random() < 0.5 ? "üéß On" : "‚ùå Off";
        simulationState.headphoneVolume = simulationState.headphoneStatus === "üéß On" ? `${getRandomInt(10,100)}%` : "N/A";
      }
      updateLeaderHeartbeat();
      updateSlowDisplay();
      await saveStateToServer(simulationState);
    }
    updateTimeField();
    setInterval(updateSlowMetrics, 30000);
    setInterval(updateTimeField, 1000);
  </script>
</body>
</html>
